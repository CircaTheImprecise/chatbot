<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dialogflow Chatbot</title>
    <style>
            body {
            background-color: #333; /* Dark grey background */
            color: #fff; /* White text */
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        #chat-container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
        }

        #chat {
            height: 300px;
            overflow-y: auto;
            border: 1px solid #555;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #444; /* Darker grey background for chat area */
        }

        .user-message, .bot-message {
            padding: 8px;
            margin: 5px;
            border-radius: 5px;
        }

        .user-message {
            background-color: #007BFF; /* Blue for user messages */
        }

        .bot-message {
            background-color: #28A745; /* Green for bot messages */
        }

        #user-input {
            width: calc(100% - 22px);
            padding: 10px;
            margin: 0;
            border: none;
            border-radius: 5px;
            display: inline-block;
            vertical-align: top;
        }

        #user-input:focus {
            outline: none;
        }

        button {
            width: 50px;
            padding: 10px;
            margin: 0;
            border: none;
            border-radius: 5px;
            display: inline-block;
            vertical-align: top;
            cursor: pointer;
            background-color: #17A2B8; /* Turquoise for the button */
            color: #fff;
        }
    </style>
</head>
<body>
    <div id="chat-container">
        <div id="chat"></div>
        <input type="text" id="user-input" placeholder="Stell mir eine Frage ...">
        <button onclick="sendMessage()">Abschicken</button>
    </div>

    <!-- Add an audio element to the HTML -->
    <audio id="audioPlayer" style="display: none;"></audio>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dialogflow@0.10.0/dist/dialogflow.min.js"></script>
    <script>
        const projectId = 'chatbot-kyyh'; // Replace with your Dialogflow project ID
        const sessionId = '123456'; // You can generate a unique session ID

        // Load your Dialogflow credentials
        const credentials = {
            client_email: 'firebase-adminsdk-wneop@chatbot-411818.iam.gserviceaccount.com',
            private_key: -----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDXvfbOQLRwMvJa\nBmDN0sBBOLpkt+X6dxkYZY6I2odoT+z1wniW8rmvux1EKZ2OHN5eSESVL8xNPNFp\nrmzXe0zXjAwprUlu+TLLwHjXL5/YtnHUHUUpoS6sx1G9x1IJT4G9XKt9wrsYItCM\nZC8y9EtfTbF6/3e+OlsBlCR2EKjptD1WLq7exE+bQR2UkkfOvv53GTY9bJP/kvHF\nQ3FL9TI2A3GziOKOP6w5ebRNEvyMxJR2e8dhmb9Jif53/NR50AWMd0BDtc0sXQIv\njlBqn/ILZK/jXaedNQU26zVD3LE4ptqQKb9/z/qFhLrHAtr/VrXlqURg8Fbcuaa/\n4nD2QC0PAgMBAAECggEAMAQNfBYWkqokGjk1LlnrhBiWE3iCbN447Z8cvAS3AlZX\njNL9d8sJ3LyuZM9GS6zNKPq4mOOMetxAV18Exmigz5BR3Ky+nT5FOefafToSP29L\nokPpcrx24OlzneNQtNXHMFgBqvm+Hj8RX02k25hXdhyalZ9qDSJ7wrwv6T8H+QtF\nuyTEGhKEowIqIjleDOqe+5lQX16SFajN/ZKkpKSwAxO6Ls1QN0NCrAbKzvywZcIl\nk/axumVVayh/y9XYnT2sZNx5Ch1Dee9anob74OXgSBmTkpNESzV/4xvscPM3Zxx+\nMcmgia4RvSXrX+BrrXVQspTJGfxB14g7mrx9jA27gQKBgQDyMkos+YNg8gtPmN7b\nTO3oRlT2ln4lcVoMNM3/fAKXtHI20sqoziHbkCvH0BJyhzi7J0UiX1fyzM7XoOn6\noIiDeKe1nPEKlnbeyvyHYIGItEs+otlH1nIeCqe9RGQ4cH5BLnylmyVewpXDzkTp\n5b15AVIXm1ql4/Fo65lsByvVrwKBgQDkCbKa+pW6BBxV5FTjkZDZ/IeFvTRmaGbR\nBd1F4H4WhrJhIUUI+8OjiFFZYQjVhL83B72eJQ9KP+aFbz9sPaGfKu2FRT/e21oA\nL/5QZT+P8/kwc2aFpK5HYJGvKcZSesuXM0Y2Ba/ZTywseI1wPftqdNR+wcUVDT7U\n7U+4A/pWoQKBgQClVveUZHHwCMz39eCNzaLMYtc1z98mKI/UrWfD9iC++AzQqG55\ndt9eSLnamo09alqsSU7E/FnKA09hnRSeaGFJf2DedtmG5NkZl3F16cgETzDe/cVf\naWJWZ+fDKaFRdlp6nQWy+Is2eZhMJ9Cb7J7AsMoeG4xym33+pngCa5LdOQKBgBSu\nrHxR7fKJHOjNZMWfFjwvIzuGBZKkNW8P0RndWpJAdT1J/zDpZL0YSAiLPHnhKFad\nZR1KzzA0y3ues2nlzRrakeBcf4Z+7pLFx5MTG8i6oAc88Dd+0C+5Gn2AlHQ2nvB/\nvgZ4TZKwE5mU9X8QoBTvs7YrbOyT3vcA7xIJilMBAoGAFMhU2D2wOZtnzr/h3mv3\nCaXIMHCpeWiUKMhg88KmuwUX7ZB/tW55XGIKbg/3xx8mjz/cV9XkbWPUfYleY435\n40pfmu3mCB8ZSfhylNRCMEVSFE4lB4HHNJWiisKRGrG5KoovCmE7xywZQWH9DTXT\ng3LHZYUGekMaHbozzOd+m6A=\n-----END PRIVATE KEY-----\n",
        };

        const sessionClient = new DF.SessionsClient({
            credentials: credentials,
        });

        function sendMessage() {
            const userInput = $('#user-input').val();
            if (userInput.trim() === '') return;

            displayMessage('user', userInput);
            $('#user-input').val('');

            // Call Dialogflow API
            callDialogflow(userInput);
        }

        async function callDialogflow(userInput) {
            const sessionPath = sessionClient.sessionPath(projectId, sessionId);

            const request = {
                session: sessionPath,
                queryInput: {
                    text: {
                        text: userInput,
                        languageCode: 'de', // German language code
                    },
                },
            };

            try {
                const responses = await sessionClient.detectIntent(request);
                const botReply = responses[0].queryResult.fulfillmentText;
                displayMessage('bot', botReply);
            } catch (error) {
                console.error('Error calling Dialogflow:', error);
            }
        }

        function displayMessage(sender, text) {
            const chat = $('#chat');
            const messageClass = sender === 'user' ? 'user-message' : 'bot-message';
            chat.append(`<div class="${messageClass}">${text}</div>`);
            chat.scrollTop(chat.prop('scrollHeight'));

            // Play audio for specific bot messages
            if (sender === 'bot') {
                playAudioForBotMessage(text);
            }
        }

        function playAudioForBotMessage(message) {
            const audioPlayer = document.getElementById('audioPlayer');
            let audioSrc = '';

            // Map bot messages to corresponding audio files
            switch (message.toLowerCase()) {
                case 'hello':
                    audioSrc = 'https://raw.githubusercontent.com/CircaTheImprecise/chatbot/main/magic.mp3';
                    break;
                case 'bye':
                    audioSrc = 'path/to/your/audio2.mp3';
                    break;
                // Add more cases for other messages and audio files as needed
                default:
                    // Use a default audio file if no match is found
                    audioSrc = 'path/to/your/default-audio.mp3';
                    break;
            }

            // Set the audio source and play it
            audioPlayer.src = audioSrc;
            audioPlayer.play();
        }
    </script>
</body>
</html>
